{% extends 'base.html' %}

{% block title %}Home - SOS Earth{% endblock %}

{% block content %}
    <!-- Background image -->
    <div id="worlddiv" style="width: 100%; height: 500px;"></div>
    <!-- Background image -->

    <!-- Carousel wrapper -->
    <div id="carouselDarkVariant" class="carousel slide carousel-fade carousel-dark bg-dark text-white px-5"
         data-mdb-ride="carousel"
         data-mdb-carousel-init>
        <!-- Inner -->
        <h6 class="fs-4 fw-lighter font-monospace text-uppercase px-3 pt-3">Vital Signs</h6>
        <div class="carousel-inner" id="carousel-inner">
            <!-- Content will be populated by JavaScript -->
        </div>
        <!-- Inner -->

        <!-- Controls -->
        <button class="carousel-control-prev" type="button" data-mdb-target="#carouselDarkVariant"
                data-mdb-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-mdb-target="#carouselDarkVariant"
                data-mdb-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
    <!-- Carousel wrapper -->
    <style>
        .big-number {
            font-size: 2rem;
        }

        .small-text {
            font-size: 0.8rem;
            position: relative;
            top: -0.5rem; /* Adjust the value to control the elevation */
        }

        .dashed-underline {
            text-decoration: underline;
            text-decoration-style: dashed;
        }

        .carousel-control-prev,
        .carousel-control-next {
            z-index: 10;
            top: 50%; /* Vertically center the controls */
            transform: translateY(-50%);
            width: 5%; /* Adjust the width to control the click area */
        }

        #worlddiv {
            background-image: radial-gradient(#06016b, black);
            color: #ffffff;
            font-family: Trebuchet MS, serif;
            flex-direction: row
        }
    </style>
    <script src="{{ url_for('static', filename='js/world.js') }}"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            fetch('/vital-signs')
                .then(response => response.json())
                .then(data => {
                    const carouselInner = document.getElementById('carousel-inner');
                    carouselInner.innerHTML = '';  // Clear any existing content

                    for (let i = 0; i < data.length; i += 4) {
                        const slideItems = data.slice(i, i + 4);
                        const activeClass = i === 0 ? 'active' : '';
                        const carouselItem = `
                            <div class="carousel-item ${activeClass}">
                                <div class="row px-3 py-1 pb-5">
                                    ${slideItems.map(item => `
                                        <div class="col h-100">
                                            <hr>
                                            <h5 class="dashed-underline ">${item.title}</h5>
                                            <div>
                                                <h6 class="d-inline big-number align-baseline">
                                                    <i class="fa-sharp fa-regular fa-arrow-${item.trend === 'down' ? 'down text-danger' : 'up text-success'}"></i> ${item.value}
                                                </h6>
                                                <span class="d-inline small-text ms-1">${item.description}</span>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>`;
                        carouselInner.insertAdjacentHTML('beforeend', carouselItem);
                    }
                })
                .catch(error => console.error('Error fetching data:', error));
        });
    </script>
{% endblock %}
